<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Japanese Pronunciation Practice</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
        button { padding: 10px 20px; font-size: 16px; }
        #status { margin-top: 20px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Japanese Pronunciation Practice</h1>
    <p>Click to record your voice saying the word:</p>
    <h2>Á∞°Âçò</h2>
    <button id="recordBtn">üé§ Record</button>
    <p id="status">Not recording</p>

    <script>
        let mediaRecorder;
        let audioChunks = [];

        document.getElementById("recordBtn").onclick = async () => {
            if (!mediaRecorder || mediaRecorder.state === "inactive") {
                let stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                mediaRecorder = new MediaRecorder(stream);

                audioChunks = [];
                mediaRecorder.ondataavailable = event => audioChunks.push(event.data);
                mediaRecorder.onstop = async () => {
                    let audioBlob = new Blob(audioChunks, { type: "audio/wav" });
                    let formData = new FormData();
                    formData.append("audio", audioBlob, "input.wav");

                    document.getElementById("status").innerText = "Uploading...";
                    let response = await fetch("https://pronounciation-feedback-tool.onrender.com", {
                        method: "POST",
                        body: formData
                    });
                    let result = await response.text();
                    document.getElementById("status").innerText = result;
                };

                mediaRecorder.start();
                document.getElementById("recordBtn").innerText = "‚èπ Stop";
                document.getElementById("status").innerText = "Recording...";
            } else {
                mediaRecorder.stop();
                document.getElementById("recordBtn").innerText = "üé§ Record";
            }
        };
    </script>
</body>
</html>

